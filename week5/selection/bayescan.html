<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2021-12-03" />
  <title>Selection Scan with BAYESCAN</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="avenir-white.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Selection Scan with BAYESCAN</h1>
<p class="date">December 3, 2021</p>
</header>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><p><a href="#preparing-input-file">1. Preparing Input File</a></p></li>
<li><p><a href="#run-bayescan">2. Run Bayescan</a></p></li>
<li><p><a href="#understanding-bayescan-output">3. Understanding Bayescan Output</a></p></li>
<li><p><a href="#visualizing-outliers">4. Visualizing Outliers</a></p></li>
</ul>
<p><br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br></p>
<h2 id="preparing-input-file">1. Preparing Input File</h2>
<p>The file conversion will be similar to how we did it for Structure using <code>PGDSpider</code>. We need the following files:</p>
<ul>
<li><p>Population file (<code>ruber.pop</code>)</p></li>
<li><p>PGDSpider template file (<code>vcf2bscan.spid</code>)</p></li>
<li><p>Input VCF file (<code>ruber_reduced_ref.vcf</code>)</p></li>
</ul>
<p>You can copy these files from: <code>/project/inbre-train/2021_popgen_wkshp/data/Bayescan</code>. Copy all files from this folder.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="bu">cd</span> /path/to/your/gscratch/folder</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="fu">cp</span> /project/inbre-train/2021_popgen_wkshp/data/Bayescan/data/* .</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="fu">ls</span> -lh</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="ex">-rw-rw-r--</span> 1 vchhatre  670 Dec  2 10:56 crovir.pop</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="ex">-rw-r--r--</span> 1 vchhatre  336 Dec  2 10:57 vcf2bscan.sh</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="ex">-rw-r--r--</span> 1 vchhatre 1.5K Dec  2 10:57 vcf2bscan.spid</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="ex">-rw-rw-r--</span> 1 vchhatre 2.6M Dec  2 10:58 ruber_reduced_ref.vcf</span></code></pre></div>
<p><br><br></p>
<h3 id="exclude-loci-with-more-than-2-alleles">1.1 Exclude Loci with More than 2 Alleles</h3>
<p>You might recall that the VCF file contains some loci with more than 2 alleles. We need to exclude those loci from further analysis because they violate the assumptions of the method (Bayescan) we are about to use.</p>
<ul>
<li>First, run a check on the vcf file:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="ex">module</span> load gcc swset perl vcftools</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="ex">vcftools</span> --vcf ruber_reduced_ref.vcf</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="ex">VCFtools</span> - 0.1.14</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="kw">(</span><span class="ex">C</span><span class="kw">)</span> <span class="ex">Adam</span> Auton and Anthony Marcketta 2009</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="ex">Parameters</span> as interpreted:</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>    <span class="ex">--vcf</span> ruber_reduced_ref.vcf</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 33 out of 33 Individuals</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 4562 out of a possible 4562 Sites</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="ex">Run</span> Time = 0.00 seconds</span></code></pre></div>
<ul>
<li>Then check for loci that have exactly two alleles</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="ex">vcftools</span> --vcf ruber_reduced_ref.vcf --min-alleles 2 --max-alleles 2</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="ex">VCFtools</span> - 0.1.14</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="kw">(</span><span class="ex">C</span><span class="kw">)</span> <span class="ex">Adam</span> Auton and Anthony Marcketta 2009</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="ex">Parameters</span> as interpreted:</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>    <span class="ex">--vcf</span> ruber_reduced_ref.vcf</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>    <span class="ex">--max-alleles</span> 2</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>    <span class="ex">--min-alleles</span> 2</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 33 out of 33 Individuals</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 4502 out of a possible 4562 Sites</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a><span class="ex">Run</span> Time = 0.00 seconds</span></code></pre></div>
<ul>
<li>So it appears that there are about 60 sites with more than 2 alleles. Let’s exclude those.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="ex">vcftools</span> --vcf ruber_reduced_ref.vcf --min-alleles 2 --max-alleles 2 --recode --out ruber_4502snp</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="ex">VCFtools</span> - 0.1.14</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="kw">(</span><span class="ex">C</span><span class="kw">)</span> <span class="ex">Adam</span> Auton and Anthony Marcketta 2009</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="ex">Parameters</span> as interpreted:</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>    <span class="ex">--vcf</span> ruber_reduced_ref.vcf</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>    <span class="ex">--max-alleles</span> 2</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>    <span class="ex">--min-alleles</span> 2</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>    <span class="ex">--out</span> ruber_4502snp</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>    <span class="ex">--recode</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 33 out of 33 Individuals</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a><span class="ex">Outputting</span> VCF file...</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 4502 out of a possible 4562 Sites</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="ex">Run</span> Time = 0.00 seconds</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a></span></code></pre></div>
<ul>
<li>Check to make sure it worked:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="ex">vcftools</span> --vcf ruber_4502snp.recode.vcf </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="ex">VCFtools</span> - 0.1.14</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="kw">(</span><span class="ex">C</span><span class="kw">)</span> <span class="ex">Adam</span> Auton and Anthony Marcketta 2009</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="ex">Parameters</span> as interpreted:</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>    <span class="ex">--vcf</span> ruber_4502snp.recode.vcf</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 33 out of 33 Individuals</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="ex">After</span> filtering, kept 4502 out of a possible 4502 Sites</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a><span class="ex">Run</span> Time = 0.00 seconds</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a></span></code></pre></div>
<ul>
<li>Good! Let’s quickly rename this file to shorten its name:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="fu">mv</span> ruber_4502snp.recode.vcf ruber_4502snp.vcf</span></code></pre></div>
<p><br><br></p>
<h3 id="check-popfile">1.2 Check Popfile</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="ex">vim</span> crovir.pop</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="ex">SD_Field_0201</span>   north</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="ex">SD_Field_0255</span>   south</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="ex">SD_Field_0386</span>   south</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="ex">SD_Field_0491</span>   south</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="ex">SD_Field_0492</span>   admixed</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="ex">SD_Field_0493</span>   south</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a><span class="ex">SD_Field_0557</span>   south</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a><span class="ex">SD_Field_0598</span>   admixed</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a><span class="ex">SD_Field_0599</span>   south</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a><span class="ex">SD_Field_0642</span>   admixed</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a><span class="ex">SD_Field_0666</span>   admixed</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a><span class="ex">SD_Field_0983</span>   north</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a><span class="ex">SD_Field_1079</span>   south</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a><span class="ex">SD_Field_1205</span>   north</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a><span class="ex">SD_Field_1220</span>   south</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a><span class="ex">SD_Field_1225</span>   south</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a><span class="ex">SD_Field_1226</span>   south</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a><span class="ex">SD_Field_1381</span>   north</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true"></a><span class="ex">SD_Field_1878</span>   north</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true"></a><span class="ex">SD_Field_1880</span>   north</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true"></a><span class="ex">SD_Field_1899</span>   north</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true"></a><span class="ex">SD_Field_1961</span>   south</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true"></a><span class="ex">SD_Field_1988</span>   south</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true"></a><span class="ex">SD_Field_1991</span>   south</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true"></a><span class="ex">SD_Field_2127</span>   north</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true"></a><span class="ex">SD_Field_2287</span>   admixed</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true"></a><span class="ex">SD_Field_2383</span>   south</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true"></a><span class="ex">SD_Field_2427</span>   south</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true"></a><span class="ex">SD_Field_2789</span>   north</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true"></a><span class="ex">SD_Field_2914</span>   south</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true"></a><span class="ex">SD_Field_2968</span>   north</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true"></a><span class="ex">SD_Field_3027</span>   north</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true"></a><span class="ex">SD_Field_3124</span>   north</span></code></pre></div>
<ul>
<li>Note that after conversion to Bayescan format, the order of individuals may change as they will be grouped by populations.</li>
</ul>
<p><br><br></p>
<h3 id="modify-the-spid-file">1.3 Modify the SPID File</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="ex">vim</span> vcf2bscan.spid</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># VCF Parser questions</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="va">PARSER_FORMAT=</span>VCF</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="co"># Only output SNPs with a phred-scaled quality of at least:</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="va">VCF_PARSER_QUAL_QUESTION=</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a><span class="co"># Select population definition file:</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="va">VCF_PARSER_POP_FILE_QUESTION=</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a><span class="co"># What is the ploidy of the data?</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a><span class="va">VCF_PARSER_PLOIDY_QUESTION=</span>DIPLOID</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a><span class="co"># Do you want to include a file with population definitions?</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a><span class="va">VCF_PARSER_POP_QUESTION=</span>true</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a><span class="co"># Output genotypes as missing if the phred-scale genotype quality is below:</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a><span class="va">VCF_PARSER_GTQUAL_QUESTION=</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a><span class="co"># Do you want to include non-polymorphic SNPs?</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a><span class="va">VCF_PARSER_MONOMORPHIC_QUESTION=</span>FALSE</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a><span class="co"># Only output following individuals (ind1, ind2, ind4, ...):</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a><span class="va">VCF_PARSER_IND_QUESTION=</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true"></a><span class="co"># Only input following regions (refSeqName:start:end, multiple regions: whitespace separated):</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true"></a><span class="va">VCF_PARSER_REGION_QUESTION=</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true"></a><span class="co"># Output genotypes as missing if the read depth of a position for the sample is below:</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true"></a><span class="va">VCF_PARSER_READ_QUESTION=</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true"></a><span class="co"># Take most likely genotype if &quot;PL&quot; or &quot;GL&quot; is given in the genotype field?</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true"></a><span class="va">VCF_PARSER_PL_QUESTION=</span>false</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true"></a><span class="co"># Do you want to exclude loci with only missing data?</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true"></a><span class="va">VCF_PARSER_EXC_MISSING_LOCI_QUESTION=</span>true</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true"></a><span class="co"># GESTE / BayeScan Writer questions</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true"></a><span class="va">WRITER_FORMAT=</span>GESTE_BAYE_SCAN</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true"></a><span class="co"># Specify which data type should be included in the GESTE / BayeScan file  (GESTE / BayeScan can only analyze one data type per file):</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true"></a><span class="va">GESTE_BAYE_SCAN_WRITER_DATA_TYPE_QUESTION=</span>SNP</span></code></pre></div>
<p><br><br></p>
<h3 id="modify-the-vcf2bscan.sh-script">1.4 Modify the <code>vcf2bscan.sh</code> Script</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="ex">vim</span> vcf2bscan.sh</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co">#!/bin/bash</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="ex">pgdspider</span>   -inputfile      <span class="kw">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>        <span class="ex">-inputformat</span> VCF    <span class="kw">\</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>        <span class="ex">-outputfile</span>         <span class="kw">\</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>        <span class="ex">-outputformat</span> GESTE_BAYE_SCAN   <span class="kw">\</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>        <span class="ex">-spid</span> vcf2bscan.spid</span></code></pre></div>
<p><br></p>
<p>Then run the script:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="ex">sbatch</span> vcf2bscan.sh</span></code></pre></div>
<p><br><br></p>
<h3 id="bayescan-input-file">1.5 Bayescan Input File</h3>
<p>Let’s take a look at the <code>ruber.bayescan</code> file</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="ex">vim</span> ruber.bayescan</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>[<span class="ex">loci</span>]=4502     </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>[<span class="ex">populations</span>]=3 </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>[<span class="ex">pop</span>]=1 </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a> <span class="ex">1</span>      24      2       16 8</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a> <span class="ex">2</span>      24      2       0 24</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a> <span class="ex">3</span>      24      2       23 1</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a> <span class="ex">4</span>      24      2       24 0</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a> <span class="ex">5</span>      18      2       0 18</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a> <span class="ex">6</span>      8       2       0 8 </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a> <span class="ex">7</span>      4       2       1 3 </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a> <span class="ex">8</span>      24      2       0 24</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a> <span class="ex">9</span>      24      2       24 0</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true"></a> <span class="ex">10</span>     24      2       4 20</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true"></a> <span class="ex">11</span>     24      2       13 11</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true"></a> <span class="ex">12</span>     24      2       1 23</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true"></a> <span class="ex">13</span>     2       2       0 2 </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true"></a> <span class="ex">14</span>     22      2       0 22</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true"></a> <span class="ex">15</span>     24      2       0 24</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true"></a> <span class="ex">16</span>     10      2       10 0</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true"></a> <span class="ex">17</span>     20      2       7 13</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true"></a> <span class="ex">18</span>     22      2       19 3</span></code></pre></div>
<ul>
<li><p>This is a partial view of the file. The fields are as follows:</p>
<ol type="1">
<li>Locus number</li>
<li>Number of genes (2x the number of diploid individuals in that population)</li>
<li>Number of alleles found in that population at that locus</li>
<li>Number of copies of each of the two alleles in the given population</li>
</ol></li>
<li><p>The number in the third column must always be 2. Our filtering of the vcf above was done precisely for this purpose. Still, you can once again verify that this number is 2 throughout:</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="fu">sed</span> -n 6,4507p ruber.bayescan <span class="kw">|</span> <span class="fu">cut</span> -f3 <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> -c</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>   <span class="ex">4502</span>  2</span></code></pre></div>
<ul>
<li>Good! Now we can proceed with Bayescan analysis.</li>
</ul>
<p><br><br><br></p>
<h2 id="run-bayescan">2. Run Bayescan</h2>
<ul>
<li>Let’s check the commandline parameters that Bayescan provides:</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="ex">module</span> load gcc swset bayescan</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a><span class="ex">bayescan</span> -h</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a> <span class="kw">|</span> <span class="ex">BayeScan</span> 2.0 usage:     <span class="kw">|</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a> <span class="ex">-help</span>        Prints this help </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a> <span class="kw">|</span> <span class="ex">Input</span>                   <span class="kw">|</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a> <span class="ex">alleles.txt</span>  Name of the genotypes data input file </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a> <span class="ex">-d</span> discarded Optional input file containing list of loci to discard</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a> <span class="ex">-snp</span>         Use SNP genotypes matrix</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a> <span class="kw">|</span> <span class="ex">Output</span>                  <span class="kw">|</span> </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true"></a> <span class="ex">-od</span> .        Output file directory, default is the same as program file</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true"></a> <span class="ex">-o</span> alleles   Output file prefix, default is input file without the extension</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true"></a> <span class="ex">-fstat</span>       Only estimate F-stats (no selection)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true"></a> <span class="ex">-all_trace</span>   Write out MCMC trace also for alpha paremeters (can be a very large file)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true"></a> <span class="kw">|</span> <span class="ex">Parameters</span> of the chain <span class="kw">|</span> </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true"></a> <span class="ex">-threads</span> n   Number of threads used, default is number of cpu available </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true"></a> <span class="ex">-n</span> 5000      Number of outputted iterations, default is 5000 </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true"></a> <span class="ex">-thin</span> 10     Thinning interval size, default is 10 </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true"></a> <span class="ex">-nbp</span> 20      Number of pilot runs, default is 20 </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true"></a> <span class="ex">-pilot</span> 5000  Length of pilot runs, default is 5000 </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true"></a> <span class="ex">-burn</span> 50000  Burn-in length, default is 50000 </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true"></a> <span class="kw">|</span> <span class="ex">Parameters</span> of the model <span class="kw">|</span> </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true"></a> <span class="ex">-pr_odds</span> 10  Prior odds for the neutral model, default is 10 </span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true"></a> <span class="ex">-lb_fis</span> 0    Lower bound for uniform prior on Fis (dominant data), <span class="ex">default</span> is 0</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true"></a> <span class="ex">-hb_fis</span> 1    Higher bound for uniform prior on Fis (dominant data), <span class="ex">default</span> is 1</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true"></a> <span class="ex">-beta_fis</span>    Optional beta prior for Fis (dominant data, m_fis and sd_fis need to be set)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true"></a> <span class="ex">-m_fis</span> 0.05  Optional mean for beta prior on Fis (dominant data with -beta_fis)</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true"></a> <span class="ex">-sd_fis</span> 0.01 Optional std. deviation for beta prior on Fis (dominant data with -beta_fis)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true"></a> <span class="ex">-aflp_pc</span> 0.1 Threshold for the recessive genotype as a fraction of maximum band intensity, default is 0.1</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true"></a> <span class="kw">|</span> <span class="ex">Output</span> files            <span class="kw">|</span> </span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true"></a> <span class="ex">---------------------------</span> </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true"></a> <span class="ex">-out_pilot</span>   Optional output file for pilot runs</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true"></a> <span class="ex">-out_freq</span>    Optional output file for allele frequencies</span></code></pre></div>
<ul>
<li><p>Here are the parameters we will be using:</p>
<ul>
<li><code>-snp</code> indicates that we are using SNP data</li>
<li><code>-od</code> specifies output directory.</li>
<li><code>-threads n</code> We will use 16 threads</li>
<li><code>-n 5000</code> Similar to structure MCMC. We will set this to 20000</li>
<li><code>-thin 10</code> Keep this as is</li>
<li><code>-nbp 20</code> Keep as is</li>
<li><code>-pilot 5000</code> This is fine as well</li>
<li><code>-burn 50000</code> Keep as is</li>
<li><code>-pr_odds 10</code> Change this to 1000. 10 is too high a number</li>
<li><code>-out_freq</code> Obtain output allele frequencies in addition to selection scan</li>
</ul></li>
<li><p>Let’s make a script:</p></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="ex">vim</span> run_bayescan.sh</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="ex">module</span> load gcc swset bayescan/2.1</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a><span class="ex">bayescan</span> ruber.bayescan -snp <span class="kw">\</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>    <span class="ex">-od</span> ruber_output    <span class="kw">\</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a>    <span class="ex">-threads</span> 16 <span class="kw">\</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a>    <span class="ex">-n</span> 5000 <span class="kw">\</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a>    <span class="ex">-thin</span> 10    <span class="kw">\</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>    <span class="ex">-nbp</span> 20 <span class="kw">\</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>    <span class="ex">-pilot</span> 5000 <span class="kw">\</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a>    <span class="ex">-burn</span> 50000 <span class="kw">\</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a>    <span class="ex">-pr_odds</span> 1000   <span class="kw">\</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>    <span class="ex">-out_freq</span>   </span></code></pre></div>
<ul>
<li>Make the output folder and run the script:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="fu">mkdir</span> ruber_output</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="ex">sbatch</span> run_bayescan.sh</span></code></pre></div>
<p><br><br></p>
<h2 id="understanding-bayescan-output">3. Understanding Bayescan Output</h2>
<p>Bayescan outputs several files depending upon parameters selected during the run. You will see the following files in the results folder:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="bu">cd</span> ruber_output</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a><span class="fu">ls</span> -lh</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="ex">-rw-rw-r--</span> 1 vchhatre 380K Dec  2 14:38 ruber.baye_Verif.txt</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a><span class="ex">-rw-rw-r--</span> 1 vchhatre  601 Dec  2 15:17 ruber.baye_AccRte.txt</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a><span class="ex">-rw-rw-r--</span> 1 vchhatre 252K Dec  2 15:17 ruber.baye.sel</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a><span class="ex">-rw-rw-r--</span> 1 vchhatre 228K Dec  2 19:16 ruber.baye_fst.txt</span></code></pre></div>
<ul>
<li>Among these files, the one ending in <code>.baye_fst.txt</code> has most of the results for selection scan. Let’s take a look.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="ex">vim</span> ruber.baye_fst.txt</span></code></pre></div>
<ul>
<li><p>Add a name for the first column. Call it loci.</p></li>
<li><p>Then replace multiple spaces between columns by a single tab</p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>:<span class="ex">%s</span>/\<span class="ex">s</span>\+/ /g</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>:<span class="ex">%s/</span> /\t/g</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>:<span class="ex">wq</span></span></code></pre></div>
<ul>
<li>Import the file into R</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="ex">module</span> load gcc swset r</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a><span class="ex">R</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>bscan &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;ruber.baye_fst.txt&quot;</span>, <span class="dt">header=</span>T)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="kw">head</span>(bscan)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a>  locus       prob log10.PO.     qval       alpha     fst</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a><span class="dv">1</span>     <span class="dv">1</span> <span class="fl">0.00080016</span>  <span class="fl">-3.09648</span> <span class="fl">0.998716</span> <span class="fl">-0.00014427</span> <span class="fl">0.32671</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a><span class="dv">2</span>     <span class="dv">2</span> <span class="fl">0.00080016</span>  <span class="fl">-3.09650</span> <span class="fl">0.998720</span> <span class="fl">-0.00025595</span> <span class="fl">0.32669</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a><span class="dv">3</span>     <span class="dv">3</span> <span class="fl">0.00100020</span>  <span class="fl">-2.99950</span> <span class="fl">0.998560</span> <span class="fl">-0.00021504</span> <span class="fl">0.32671</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a><span class="dv">4</span>     <span class="dv">4</span> <span class="fl">0.00080016</span>  <span class="fl">-3.09650</span> <span class="fl">0.998720</span> <span class="fl">-0.00038205</span> <span class="fl">0.32668</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a><span class="dv">5</span>     <span class="dv">5</span> <span class="fl">0.00060012</span>  <span class="fl">-3.22150</span> <span class="fl">0.998840</span> <span class="fl">-0.00012257</span> <span class="fl">0.32671</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a><span class="dv">6</span>     <span class="dv">6</span> <span class="fl">0.00060012</span>  <span class="fl">-3.22150</span> <span class="fl">0.998840</span>  <span class="fl">0.00085670</span> <span class="fl">0.32693</span></span></code></pre></div>
<p>Here: - <code>prob</code> is the posterior probability of selection acting on a locus - <code>log10.PO.</code> is the log10 of the posterior odds of the model testing for selection. The value in this column is set to 1000 when the posterior probability is <code>1</code>. - <code>alpha</code> is a coefficient indicating the strength and direction of selection. Positive values indicate diversifying selection and negative values, purifying selection. - <code>qval</code> is the multiple testing p-value obtained after testing each locus for selection.</p>
<ul>
<li>Essentially, if a locus is determined to be candidate for selection, it’s <code>qvalue</code> should be very small. Let’s check the range of these values.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="kw">range</span>(bscan<span class="op">$</span>qval)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="fl">0.90958</span> <span class="fl">0.99897</span></span></code></pre></div>
<ul>
<li><p>This indicates that there are no loci that can be considered candidates for selection.</p></li>
<li><p>It’s possible that the prior odds we set (<code>pr_odds=1000</code>) is too small. Maybe we should increase those odds by an order of magnitude (say 100). We can rerun the analysis by making two small changes to the script:</p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="ex">vim</span> run_bayescan.sh</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="ex">-pr_odds</span> 100</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a><span class="ex">-od</span> ruber_output_prior100</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="fu">mkdir</span> ruber_output_prior100</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a><span class="ex">sbatch</span> run_bayescan.sh</span></code></pre></div>
<ul>
<li>After the run finishes, check the results to see if any loci are candidates for selection.</li>
</ul>
<p><br><br></p>
<h2 id="visualizing-outliers">4. Visualizing Outliers</h2>
<p>Because our current data set does not seem to have any outliers showing extreme allele frequency differences, we will switch to a different data set for illustration purposes. You can find this data inside the <code>data/</code> folder for this week on Github.</p>
<p><br></p>
<h3 id="download-the-data">4.1 Download the Data</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="bu">cd</span> Bayescan</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="fu">wget</span> https://github.com/wyoibc/popgen_workshop/tree/master/week5/selection/data/test_baye_fst.txt</span></code></pre></div>
<p><br><br></p>
<h3 id="check-for-outliers">4.2 Check for Outliers</h3>
<ul>
<li>Import the data into R</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>test &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;test.baye_fst.txt&quot;</span>, <span class="dt">header=</span>T)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a><span class="kw">head</span>(test)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>        prob  log10.PO.     qval       alpha      fst</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a><span class="dv">1</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997644</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a><span class="dv">2</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997640</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a><span class="dv">3</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997640</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a><span class="dv">4</span> <span class="fl">0.00020004</span>    <span class="fl">-3.6988</span> <span class="fl">0.994060</span>  <span class="fl">1.5625e-04</span> <span class="fl">0.022324</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a><span class="dv">5</span> <span class="fl">0.00020004</span>    <span class="fl">-3.6988</span> <span class="fl">0.994060</span> <span class="fl">-5.8927e-05</span> <span class="fl">0.022318</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a><span class="dv">6</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997640</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span></code></pre></div>
<ul>
<li>How many loci in this data set?</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="kw">dim</span>(test)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="dv">107309</span>      <span class="dv">5</span></span></code></pre></div>
<ul>
<li>What is the range of corrected P values (i.e. q values)?</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">range</span>(test<span class="op">$</span>qval)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="fl">0.000000</span> <span class="fl">0.997644</span></span></code></pre></div>
<ul>
<li>Let’s make a quick histogram of qvalues:</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>test) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x=</span>qval), <span class="dt">binwidth=</span><span class="fl">0.01</span>)</span></code></pre></div>
<ul>
<li>It’s hard to read this histogram because a fraction of the loci distributed in the significant region is too small compared to the number of non-significant loci. Let’s check manually.</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="kw">sum</span>(test<span class="op">$</span>qval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="dv">222</span></span></code></pre></div>
<ul>
<li>What about a more stringent qval, say 0.001?</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="kw">sum</span>(test<span class="op">$</span>qval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.001</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a><span class="dv">145</span></span></code></pre></div>
<ul>
<li>Let’s find out more data on these significant loci:</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="kw">subset</span>(test, qval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.001</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a>         prob log10.PO.       qval  alpha      fst</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a><span class="dv">1566</span>   <span class="fl">0.9918</span>    <span class="fl">2.0825</span> <span class="fl">4.6531e-04</span> <span class="fl">1.7248</span> <span class="fl">0.114760</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a><span class="dv">1568</span>   <span class="fl">0.9882</span>    <span class="fl">1.9229</span> <span class="fl">9.2708e-04</span> <span class="fl">1.7285</span> <span class="fl">0.115480</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a><span class="dv">1700</span>   <span class="fl">0.9892</span>    <span class="fl">1.9618</span> <span class="fl">8.5156e-04</span> <span class="fl">1.7330</span> <span class="fl">0.115720</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a><span class="dv">1702</span>   <span class="fl">0.9964</span>    <span class="fl">2.4420</span> <span class="fl">2.5378e-04</span> <span class="fl">1.7605</span> <span class="fl">0.117830</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a><span class="dv">3159</span>   <span class="fl">0.9912</span>    <span class="fl">2.0516</span> <span class="fl">5.8297e-04</span> <span class="fl">1.6601</span> <span class="fl">0.108270</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true"></a><span class="dv">3192</span>   <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9705</span> <span class="fl">0.138040</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true"></a><span class="dv">6013</span>   <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.8917</span> <span class="fl">0.278710</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true"></a><span class="dv">6650</span>   <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.0830</span> <span class="fl">0.153020</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true"></a><span class="dv">6931</span>   <span class="fl">0.9996</span>    <span class="fl">3.3977</span> <span class="fl">2.2613e-05</span> <span class="fl">2.2409</span> <span class="fl">0.174450</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true"></a><span class="dv">12697</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8961</span> <span class="fl">0.131350</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true"></a><span class="dv">14156</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1488</span> <span class="fl">0.159040</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true"></a><span class="dv">14171</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.2797</span> <span class="fl">0.176420</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true"></a><span class="dv">14201</span>  <span class="fl">0.9998</span>    <span class="fl">3.6988</span> <span class="fl">9.0108e-06</span> <span class="fl">1.7465</span> <span class="fl">0.116600</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true"></a><span class="dv">14954</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.6822</span> <span class="fl">0.239490</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true"></a><span class="dv">18125</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1727</span> <span class="fl">0.164620</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true"></a><span class="dv">18300</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9129</span> <span class="fl">0.131840</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true"></a><span class="dv">18322</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.6018</span> <span class="fl">0.101940</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true"></a><span class="dv">18394</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8083</span> <span class="fl">0.121450</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true"></a><span class="dv">18396</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8114</span> <span class="fl">0.121840</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true"></a><span class="dv">24167</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.2193</span> <span class="fl">0.167970</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true"></a><span class="dv">24395</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8848</span> <span class="fl">0.128070</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true"></a><span class="dv">26773</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7408</span> <span class="fl">0.114220</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true"></a><span class="dv">27418</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.4339</span> <span class="fl">0.196440</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true"></a><span class="dv">27423</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.0684</span> <span class="fl">0.148980</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true"></a><span class="dv">31272</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.4578</span> <span class="fl">0.203560</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true"></a><span class="dv">34814</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8200</span> <span class="fl">0.122140</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true"></a><span class="dv">34830</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8360</span> <span class="fl">0.124590</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true"></a><span class="dv">36086</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8240</span> <span class="fl">0.121930</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true"></a><span class="dv">39272</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">3.5160</span> <span class="fl">0.396580</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true"></a><span class="dv">39876</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9194</span> <span class="fl">0.133520</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true"></a><span class="dv">39889</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8886</span> <span class="fl">0.130840</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true"></a><span class="dv">39890</span>  <span class="fl">0.9994</span>    <span class="fl">3.2215</span> <span class="fl">3.7296e-05</span> <span class="fl">1.8842</span> <span class="fl">0.130450</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true"></a><span class="dv">39910</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8167</span> <span class="fl">0.123000</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true"></a><span class="dv">42021</span>  <span class="fl">0.9974</span>    <span class="fl">2.5838</span> <span class="fl">2.0762e-04</span> <span class="fl">2.3243</span> <span class="fl">0.188730</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true"></a><span class="dv">42351</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1141</span> <span class="fl">0.154780</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true"></a><span class="dv">43349</span>  <span class="fl">0.9984</span>    <span class="fl">2.7951</span> <span class="fl">1.0955e-04</span> <span class="fl">3.3251</span> <span class="fl">0.364780</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true"></a><span class="dv">43516</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7734</span> <span class="fl">0.118360</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true"></a><span class="dv">43760</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8764</span> <span class="fl">0.129290</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true"></a><span class="dv">43771</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1364</span> <span class="fl">0.159980</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true"></a><span class="dv">43775</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1471</span> <span class="fl">0.161570</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true"></a><span class="dv">43778</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1421</span> <span class="fl">0.160850</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true"></a><span class="dv">45050</span>  <span class="fl">0.9998</span>    <span class="fl">3.6988</span> <span class="fl">9.0108e-06</span> <span class="fl">1.7325</span> <span class="fl">0.114640</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true"></a><span class="dv">45053</span>  <span class="fl">0.9926</span>    <span class="fl">2.1275</span> <span class="fl">4.0884e-04</span> <span class="fl">1.6045</span> <span class="fl">0.103530</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true"></a><span class="dv">46669</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8368</span> <span class="fl">0.126170</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true"></a><span class="dv">46861</span>  <span class="fl">0.9986</span>    <span class="fl">2.8532</span> <span class="fl">8.5501e-05</span> <span class="fl">1.8843</span> <span class="fl">0.130930</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true"></a><span class="dv">48480</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8787</span> <span class="fl">0.129220</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true"></a><span class="dv">49162</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7046</span> <span class="fl">0.111360</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true"></a><span class="dv">50013</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8834</span> <span class="fl">0.128270</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true"></a><span class="dv">51912</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7774</span> <span class="fl">0.118170</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true"></a><span class="dv">51917</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8019</span> <span class="fl">0.120470</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true"></a><span class="dv">51920</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8123</span> <span class="fl">0.121500</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true"></a><span class="dv">51936</span>  <span class="fl">0.9976</span>    <span class="fl">2.6187</span> <span class="fl">1.8935e-04</span> <span class="fl">1.5646</span> <span class="fl">0.099173</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true"></a><span class="dv">53114</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7699</span> <span class="fl">0.117520</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true"></a><span class="dv">54009</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.6047</span> <span class="fl">0.228290</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true"></a><span class="dv">54544</span>  <span class="fl">0.9990</span>    <span class="fl">2.9995</span> <span class="fl">6.3947e-05</span> <span class="fl">1.7931</span> <span class="fl">0.120470</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true"></a><span class="dv">57035</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.5100</span> <span class="fl">0.212890</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true"></a><span class="dv">58556</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1872</span> <span class="fl">0.168830</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true"></a><span class="dv">58559</span>  <span class="fl">0.9998</span>    <span class="fl">3.6988</span> <span class="fl">9.0108e-06</span> <span class="fl">1.9893</span> <span class="fl">0.144050</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true"></a><span class="dv">59329</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.6750</span> <span class="fl">0.108510</span></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true"></a><span class="dv">59877</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8073</span> <span class="fl">0.121550</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true"></a><span class="dv">59878</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8124</span> <span class="fl">0.122040</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true"></a><span class="dv">61797</span>  <span class="fl">0.9998</span>    <span class="fl">3.6988</span> <span class="fl">9.0108e-06</span> <span class="fl">2.4507</span> <span class="fl">0.205690</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true"></a><span class="dv">66090</span>  <span class="fl">0.9998</span>    <span class="fl">3.6988</span> <span class="fl">9.0108e-06</span> <span class="fl">1.8892</span> <span class="fl">0.131120</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true"></a><span class="dv">66817</span>  <span class="fl">0.9992</span>    <span class="fl">3.0965</span> <span class="fl">5.6210e-05</span> <span class="fl">1.7872</span> <span class="fl">0.120200</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true"></a><span class="dv">70550</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.5538</span> <span class="fl">0.215940</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true"></a><span class="dv">70551</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">4.2592</span> <span class="fl">0.559140</span></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true"></a><span class="dv">70553</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">3.1107</span> <span class="fl">0.311520</span></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true"></a><span class="dv">70554</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">3.0005</span> <span class="fl">0.290330</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true"></a><span class="dv">70556</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.2939</span> <span class="fl">0.177830</span></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true"></a><span class="dv">70557</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">4.0050</span> <span class="fl">0.502850</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true"></a><span class="dv">70561</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">3.0837</span> <span class="fl">0.309730</span></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true"></a><span class="dv">70564</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">3.1913</span> <span class="fl">0.330880</span></span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true"></a><span class="dv">70578</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.5996</span> <span class="fl">0.220910</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true"></a><span class="dv">70606</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.3432</span> <span class="fl">0.184770</span></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true"></a><span class="dv">70607</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.3465</span> <span class="fl">0.185260</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true"></a><span class="dv">70616</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.2087</span> <span class="fl">0.170270</span></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true"></a><span class="dv">70617</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1985</span> <span class="fl">0.167620</span></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true"></a><span class="dv">70656</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.0993</span> <span class="fl">0.153160</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true"></a><span class="dv">70684</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.5772</span> <span class="fl">0.218370</span></span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true"></a><span class="dv">70738</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1389</span> <span class="fl">0.159600</span></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true"></a><span class="dv">71234</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9073</span> <span class="fl">0.131420</span></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true"></a><span class="dv">71265</span>  <span class="fl">0.9992</span>    <span class="fl">3.0965</span> <span class="fl">5.6210e-05</span> <span class="fl">1.7616</span> <span class="fl">0.117380</span></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true"></a><span class="dv">71646</span>  <span class="fl">0.9996</span>    <span class="fl">3.3977</span> <span class="fl">2.2613e-05</span> <span class="fl">1.7175</span> <span class="fl">0.113440</span></span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true"></a><span class="dv">71734</span>  <span class="fl">0.9914</span>    <span class="fl">2.0617</span> <span class="fl">5.2385e-04</span> <span class="fl">1.5526</span> <span class="fl">0.098594</span></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true"></a><span class="dv">71796</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9577</span> <span class="fl">0.137990</span></span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true"></a><span class="dv">72584</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.0383</span> <span class="fl">0.146730</span></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true"></a><span class="dv">73227</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.6270</span> <span class="fl">0.104190</span></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true"></a><span class="dv">74211</span>  <span class="fl">0.9996</span>    <span class="fl">3.3977</span> <span class="fl">2.2613e-05</span> <span class="fl">1.8806</span> <span class="fl">0.129400</span></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true"></a><span class="dv">74218</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8432</span> <span class="fl">0.125520</span></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true"></a><span class="dv">75864</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9789</span> <span class="fl">0.140180</span></span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true"></a><span class="dv">75866</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.7676</span> <span class="fl">0.249840</span></span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true"></a><span class="dv">75878</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1729</span> <span class="fl">0.161350</span></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true"></a><span class="dv">75883</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1389</span> <span class="fl">0.157320</span></span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true"></a><span class="dv">75885</span>  <span class="fl">0.9994</span>    <span class="fl">3.2215</span> <span class="fl">3.7296e-05</span> <span class="fl">1.8061</span> <span class="fl">0.122380</span></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true"></a><span class="dv">75888</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.4178</span> <span class="fl">0.194010</span></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true"></a><span class="dv">75890</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.6357</span> <span class="fl">0.227440</span></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true"></a><span class="dv">75898</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.3120</span> <span class="fl">0.181250</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true"></a><span class="dv">75905</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9456</span> <span class="fl">0.135850</span></span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true"></a><span class="dv">75912</span>  <span class="fl">0.9926</span>    <span class="fl">2.1275</span> <span class="fl">4.0884e-04</span> <span class="fl">1.7759</span> <span class="fl">0.121080</span></span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true"></a><span class="dv">75926</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9559</span> <span class="fl">0.135670</span></span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true"></a><span class="dv">75927</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1450</span> <span class="fl">0.157700</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true"></a><span class="dv">75928</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1193</span> <span class="fl">0.154380</span></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true"></a><span class="dv">75930</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1279</span> <span class="fl">0.155580</span></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true"></a><span class="dv">75937</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9697</span> <span class="fl">0.137130</span></span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true"></a><span class="dv">75938</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9587</span> <span class="fl">0.135820</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true"></a><span class="dv">75944</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1021</span> <span class="fl">0.152210</span></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true"></a><span class="dv">76005</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.2737</span> <span class="fl">0.173680</span></span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true"></a><span class="dv">76042</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.4141</span> <span class="fl">0.193430</span></span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true"></a><span class="dv">76057</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8734</span> <span class="fl">0.126780</span></span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true"></a><span class="dv">76066</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.8605</span> <span class="fl">0.125540</span></span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true"></a><span class="dv">77901</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.8892</span> <span class="fl">0.270770</span></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true"></a><span class="dv">80748</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7523</span> <span class="fl">0.116020</span></span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true"></a><span class="dv">82861</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.5742</span> <span class="fl">0.218460</span></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true"></a><span class="dv">82866</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.4787</span> <span class="fl">0.203660</span></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true"></a><span class="dv">82964</span>  <span class="fl">0.9906</span>    <span class="fl">2.0227</span> <span class="fl">6.4552e-04</span> <span class="fl">1.6380</span> <span class="fl">0.107080</span></span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true"></a><span class="dv">84287</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1068</span> <span class="fl">0.153700</span></span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true"></a><span class="dv">85403</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">3.4112</span> <span class="fl">0.378160</span></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true"></a><span class="dv">85513</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7578</span> <span class="fl">0.116680</span></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true"></a><span class="dv">90464</span>  <span class="fl">0.9896</span>    <span class="fl">1.9783</span> <span class="fl">7.8197e-04</span> <span class="fl">1.4717</span> <span class="fl">0.091847</span></span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true"></a><span class="dv">92350</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9689</span> <span class="fl">0.139440</span></span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true"></a><span class="dv">92465</span>  <span class="fl">0.9928</span>    <span class="fl">2.1394</span> <span class="fl">3.0525e-04</span> <span class="fl">1.6781</span> <span class="fl">0.110270</span></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true"></a><span class="dv">92826</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.7041</span> <span class="fl">0.111780</span></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true"></a><span class="dv">93197</span>  <span class="fl">0.9978</span>    <span class="fl">2.6565</span> <span class="fl">1.7234e-04</span> <span class="fl">1.6590</span> <span class="fl">0.107790</span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true"></a><span class="dv">93198</span>  <span class="fl">0.9978</span>    <span class="fl">2.6565</span> <span class="fl">1.7234e-04</span> <span class="fl">1.6682</span> <span class="fl">0.108520</span></span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true"></a><span class="dv">93199</span>  <span class="fl">0.9980</span>    <span class="fl">2.6980</span> <span class="fl">1.2443e-04</span> <span class="fl">1.6750</span> <span class="fl">0.109240</span></span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true"></a><span class="dv">93639</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.2083</span> <span class="fl">0.171480</span></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true"></a><span class="dv">93640</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1260</span> <span class="fl">0.160500</span></span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true"></a><span class="dv">94661</span>  <span class="fl">0.9992</span>    <span class="fl">3.0965</span> <span class="fl">5.6210e-05</span> <span class="fl">1.7318</span> <span class="fl">0.114580</span></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true"></a><span class="dv">96296</span>  <span class="fl">0.9978</span>    <span class="fl">2.6565</span> <span class="fl">1.7234e-04</span> <span class="fl">1.7500</span> <span class="fl">0.116770</span></span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true"></a><span class="dv">97405</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.2977</span> <span class="fl">0.180220</span></span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true"></a><span class="dv">97407</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.3241</span> <span class="fl">0.183260</span></span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true"></a><span class="dv">97998</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.0376</span> <span class="fl">0.147430</span></span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true"></a><span class="dv">98445</span>  <span class="fl">0.9984</span>    <span class="fl">2.7951</span> <span class="fl">1.0955e-04</span> <span class="fl">1.5071</span> <span class="fl">0.094143</span></span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true"></a><span class="dv">98528</span>  <span class="fl">0.9896</span>    <span class="fl">1.9783</span> <span class="fl">7.8197e-04</span> <span class="fl">1.6129</span> <span class="fl">0.104540</span></span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true"></a><span class="dv">99021</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.9148</span> <span class="fl">0.133740</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true"></a><span class="dv">99396</span>  <span class="fl">0.9970</span>    <span class="fl">2.5215</span> <span class="fl">2.2862e-04</span> <span class="fl">1.6005</span> <span class="fl">0.102600</span></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true"></a><span class="dv">99397</span>  <span class="fl">0.9994</span>    <span class="fl">3.2215</span> <span class="fl">3.7296e-05</span> <span class="fl">1.6167</span> <span class="fl">0.103720</span></span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true"></a><span class="dv">99398</span>  <span class="fl">0.9986</span>    <span class="fl">2.8532</span> <span class="fl">8.5501e-05</span> <span class="fl">1.6158</span> <span class="fl">0.103810</span></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true"></a><span class="dv">99430</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.5618</span> <span class="fl">0.220810</span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true"></a><span class="dv">99694</span>  <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.9127</span> <span class="fl">0.274370</span></span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true"></a><span class="dv">103772</span> <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">1.6848</span> <span class="fl">0.109560</span></span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true"></a><span class="dv">105015</span> <span class="fl">0.9996</span>    <span class="fl">3.3977</span> <span class="fl">2.2613e-05</span> <span class="fl">2.4267</span> <span class="fl">0.203410</span></span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true"></a><span class="dv">105025</span> <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1251</span> <span class="fl">0.158070</span></span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true"></a><span class="dv">105030</span> <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.1370</span> <span class="fl">0.159030</span></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true"></a><span class="dv">106061</span> <span class="fl">1.0000</span> <span class="fl">1000.0000</span> <span class="fl">0.0000e+00</span> <span class="fl">2.0283</span> <span class="fl">0.145150</span></span></code></pre></div>
<ul>
<li><p>Some interpretations from this table:</p>
<ul>
<li><p>All of these loci have a very probability of being under selection (see column 1)</p></li>
<li><p>As stated in Bayescan manual, where probability is 1, the log10(PO) is set to 1000</p></li>
<li><p>The <code>alpha</code> parameter value is positive for all loci indicating diversifying selection</p></li>
<li><p>The population <code>fst</code> is quite high. What constitutes high fst changes depending upon biology of the species. This data is from poplar trees which are open pollinated and generally have low divergence between populations. If you compare these fsts to those of selectively neutral loci, you will find the latter to be quite low.</p></li>
</ul></li>
</ul>
<p><br><br></p>
<h3 id="visualize-outliers">4.3 Visualize Outliers</h3>
<ul>
<li><p>Bayescan ships with a R script that aids in quickly plotting this data.</p></li>
<li><p>Get the script from here:</p></li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="fu">wget</span> https://github.com/wyoibc/popgen_workshop/tree/master/week5/selection/data/plot_R.r</span></code></pre></div>
<ul>
<li>Source the script</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="kw">source</span>(<span class="st">&quot;plot_R.r&quot;</span>)</span></code></pre></div>
<ul>
<li>Run the plotting function on our test data</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="kw">plot_bayescan</span>(<span class="st">&quot;test.baye_fst.txt&quot;</span>, <span class="dt">FDR=</span><span class="fl">0.001</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true"></a><span class="op">$</span>outliers</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true"></a>  [<span class="dv">1</span>]   <span class="dv">1566</span>   <span class="dv">1568</span>   <span class="dv">1700</span>   <span class="dv">1702</span>   <span class="dv">3159</span>   <span class="dv">3192</span>   <span class="dv">6013</span>   <span class="dv">6650</span>   <span class="dv">6931</span>  <span class="dv">12697</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true"></a> [<span class="dv">11</span>]  <span class="dv">14156</span>  <span class="dv">14171</span>  <span class="dv">14201</span>  <span class="dv">14954</span>  <span class="dv">18125</span>  <span class="dv">18300</span>  <span class="dv">18322</span>  <span class="dv">18394</span>  <span class="dv">18396</span>  <span class="dv">24167</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true"></a> [<span class="dv">21</span>]  <span class="dv">24395</span>  <span class="dv">26773</span>  <span class="dv">27418</span>  <span class="dv">27423</span>  <span class="dv">31272</span>  <span class="dv">34814</span>  <span class="dv">34830</span>  <span class="dv">36086</span>  <span class="dv">39272</span>  <span class="dv">39876</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true"></a> [<span class="dv">31</span>]  <span class="dv">39889</span>  <span class="dv">39890</span>  <span class="dv">39910</span>  <span class="dv">42021</span>  <span class="dv">42351</span>  <span class="dv">43349</span>  <span class="dv">43516</span>  <span class="dv">43760</span>  <span class="dv">43771</span>  <span class="dv">43775</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true"></a> [<span class="dv">41</span>]  <span class="dv">43778</span>  <span class="dv">45050</span>  <span class="dv">45053</span>  <span class="dv">46669</span>  <span class="dv">46861</span>  <span class="dv">48480</span>  <span class="dv">49162</span>  <span class="dv">50013</span>  <span class="dv">51912</span>  <span class="dv">51917</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true"></a> [<span class="dv">51</span>]  <span class="dv">51920</span>  <span class="dv">51936</span>  <span class="dv">53114</span>  <span class="dv">54009</span>  <span class="dv">54544</span>  <span class="dv">57035</span>  <span class="dv">58556</span>  <span class="dv">58559</span>  <span class="dv">59329</span>  <span class="dv">59877</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true"></a> [<span class="dv">61</span>]  <span class="dv">59878</span>  <span class="dv">61797</span>  <span class="dv">66090</span>  <span class="dv">66817</span>  <span class="dv">70550</span>  <span class="dv">70551</span>  <span class="dv">70553</span>  <span class="dv">70554</span>  <span class="dv">70556</span>  <span class="dv">70557</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true"></a> [<span class="dv">71</span>]  <span class="dv">70561</span>  <span class="dv">70564</span>  <span class="dv">70578</span>  <span class="dv">70606</span>  <span class="dv">70607</span>  <span class="dv">70616</span>  <span class="dv">70617</span>  <span class="dv">70656</span>  <span class="dv">70684</span>  <span class="dv">70738</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true"></a> [<span class="dv">81</span>]  <span class="dv">71234</span>  <span class="dv">71265</span>  <span class="dv">71646</span>  <span class="dv">71734</span>  <span class="dv">71796</span>  <span class="dv">72584</span>  <span class="dv">73227</span>  <span class="dv">74211</span>  <span class="dv">74218</span>  <span class="dv">75864</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true"></a> [<span class="dv">91</span>]  <span class="dv">75866</span>  <span class="dv">75878</span>  <span class="dv">75883</span>  <span class="dv">75885</span>  <span class="dv">75888</span>  <span class="dv">75890</span>  <span class="dv">75898</span>  <span class="dv">75905</span>  <span class="dv">75912</span>  <span class="dv">75926</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true"></a>[<span class="dv">101</span>]  <span class="dv">75927</span>  <span class="dv">75928</span>  <span class="dv">75930</span>  <span class="dv">75937</span>  <span class="dv">75938</span>  <span class="dv">75944</span>  <span class="dv">76005</span>  <span class="dv">76042</span>  <span class="dv">76057</span>  <span class="dv">76066</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true"></a>[<span class="dv">111</span>]  <span class="dv">77901</span>  <span class="dv">80748</span>  <span class="dv">82861</span>  <span class="dv">82866</span>  <span class="dv">82964</span>  <span class="dv">84287</span>  <span class="dv">85403</span>  <span class="dv">85513</span>  <span class="dv">90464</span>  <span class="dv">92350</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true"></a>[<span class="dv">121</span>]  <span class="dv">92465</span>  <span class="dv">92826</span>  <span class="dv">93197</span>  <span class="dv">93198</span>  <span class="dv">93199</span>  <span class="dv">93639</span>  <span class="dv">93640</span>  <span class="dv">94661</span>  <span class="dv">96296</span>  <span class="dv">97405</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true"></a>[<span class="dv">131</span>]  <span class="dv">97407</span>  <span class="dv">97998</span>  <span class="dv">98445</span>  <span class="dv">98528</span>  <span class="dv">99021</span>  <span class="dv">99396</span>  <span class="dv">99397</span>  <span class="dv">99398</span>  <span class="dv">99430</span>  <span class="dv">99694</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true"></a>[<span class="dv">141</span>] <span class="dv">103772</span> <span class="dv">105015</span> <span class="dv">105025</span> <span class="dv">105030</span> <span class="dv">106061</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true"></a><span class="op">$</span>nb_outliers</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="dv">145</span></span></code></pre></div>
<center>
<img src="data/test_bayescan.png" width=750 />
</center>
<p><br><br></p>
<h3 id="chromosome-wise-distribution-of-outliers">4.4 Chromosome-Wise Distribution of Outliers</h3>
<ul>
<li>Another way of visualizing this data is make a Manhattan plot of all chromosomes. For this, you will need the chromosome number and base pair positions for each of the loci in this data set. Get that data below:</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="fu">wget</span> https://github.com/wyoibc/popgen_workshop/tree/master/week5/selection/data/test_chrpos.baye_fst.txt</span></code></pre></div>
<ul>
<li>Import the data into R</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a>test2 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;test_chrpos.baye_fst.txt&quot;</span>, <span class="dt">header=</span>T)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a><span class="kw">head</span>(test2)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a>  CHR   POS num       prob    log10PO     qval       alpha      fst</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a><span class="dv">1</span>  <span class="dv">10</span> <span class="dv">25550</span>   <span class="dv">1</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997644</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true"></a><span class="dv">2</span>  <span class="dv">10</span> <span class="dv">25560</span>   <span class="dv">2</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997640</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true"></a><span class="dv">3</span>  <span class="dv">10</span> <span class="dv">25567</span>   <span class="dv">3</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997640</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true"></a><span class="dv">4</span>  <span class="dv">10</span> <span class="dv">25597</span>   <span class="dv">4</span> <span class="fl">0.00020004</span>    <span class="fl">-3.6988</span> <span class="fl">0.994060</span>  <span class="fl">1.5625e-04</span> <span class="fl">0.022324</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true"></a><span class="dv">5</span>  <span class="dv">10</span> <span class="dv">25600</span>   <span class="dv">5</span> <span class="fl">0.00020004</span>    <span class="fl">-3.6988</span> <span class="fl">0.994060</span> <span class="fl">-5.8927e-05</span> <span class="fl">0.022318</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true"></a><span class="dv">6</span>  <span class="dv">10</span> <span class="dv">25602</span>   <span class="dv">6</span> <span class="fl">0.00000000</span> <span class="fl">-1000.0000</span> <span class="fl">0.997640</span>  <span class="fl">0.0000e+00</span> <span class="fl">0.022319</span></span></code></pre></div>
<p>Now let’s draw the Manhattan plot</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="kw">palette</span>(<span class="kw">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true"></a><span class="kw">pdf</span>(<span class="st">&quot;test_bayescan_mh.pdf&quot;</span>, <span class="dt">width=</span><span class="dv">10</span>, <span class="dt">height=</span><span class="dv">8</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">107309</span>), <span class="op">-</span><span class="kw">log10</span>(test2<span class="op">$</span>qval), <span class="dt">col=</span>test2<span class="op">$</span>CHR, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.5</span>, <span class="dt">xlab=</span><span class="st">&quot;Chromosomes&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;-log10(qval)&quot;</span>, <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<center>
<img src="data/test_bayescan_mh.png" width=750 />
</center>
<ul>
<li>Notice that the chromosomes are not being ordered correctly in this plot. We will quickly fix that.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a>test2_order &lt;-<span class="st"> </span>test2[<span class="kw">order</span>(test2<span class="op">$</span>CHR),]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a><span class="kw">palette</span>(<span class="kw">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true"></a><span class="kw">pdf</span>(<span class="st">&quot;test_bayescan_mh_ordered.pdf&quot;</span>, <span class="dt">width=</span><span class="dv">10</span>, <span class="dt">height=</span><span class="dv">8</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">107309</span>), <span class="op">-</span><span class="kw">log10</span>(test2_order<span class="op">$</span>qval), <span class="dt">col=</span>test2_order<span class="op">$</span>CHR, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.5</span>, <span class="dt">xlab=</span><span class="st">&quot;Chromosomes&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;-log10(qval)&quot;</span>, <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<center>
<img src="data/test_bayescan_mh_ordered.png" width=750 />
</center>
</body>
</html>
